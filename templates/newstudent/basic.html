{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load staticfiles %}

{% block title %}
New student survey
{% endblock %}

<style>
{% block style %}
.business-header {
    height: 400px;
    background: url('{% static "img/NewStudent2.jpg" %}') center center no-repeat scroll;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    background-size: cover;
    -o-background-size: cover;
}
.word_count {
    font-size: 0.75;
    color:#a7a9ac;
}
{% endblock %}
</style>

{% block tagline %}
    New Student Survey
{% endblock tagline %}

{% block content %}
<form action="/newstudent/" method="post">{% csrf_token %}

<section id="intro" class="container content-section">
    <div class="row" align="left">
        <div class="col-lg-8 col-lg-offset-2">
        {% if form.errors %}
        <p class="errorlist" style="font-size: 18px; font-weight: bolder">
        Error: you have incorrectly filled out some part of the survey. Please scroll down to see the red error text.
        </p>
        {% endif %}
        <h3>Let’s Get Coffee uses this survey to pair up you up with an upperclassman for an informal, 30-minute meeting (coffee optional). Your responses to these questions will be shared with upperclassmen in your college/major. You’ll ultimately be selected by one of them to meet up sometime on campus.</h3>
    </div>

    <div class="row" align="left">
        <div class="col-lg-8 col-lg-offset-2">
        <h2>Basic information</h2>
        {{ form|crispy }}
        <p>Your response will only be successfully submitted if you proceed to a thanks page; otherwise, there is an error in your survey responses that must be corrected. Thanks!</p>
        <br>
        </div>
        <div class="col-lg-8 col-lg-offset-2 text-center">
            <input class='btn btn-default btn-lg' type="submit" value="Submit" />
        </div>
    </div>
</section>
</form>
{% endblock %}

<script>
{% block script %}
$(function() {
    //word count
    function wordCount(val){
        return {
            charactersNoSpaces : val.replace(/\s+/g, '').length,
            characters         : val.length,
            words              : val.match(/\S+/g).length,
            lines              : val.split(/\r*\n/).length
        };
    }

    $('label[for*="sa"').append("<span class='word_count'>125 words.</span>");
    $('textarea').keypress(function() {
        var c = wordCount( $(this).val() );
        var sa_id = $(this).attr('id');
        $('label[for="' + sa_id + '"] span.word_count').text("  " + c.words + " words.");
    })

    // remove error when user starts typing
    //deal with input boxes
    var $errordivs = $('div.has-error');
    $errordivs.keypress(function() {
        $(this).removeClass('has-error');
    })
    //deal with radiobuttons
    $errordivs.find('input[type="checkbox"]').click(function() {
        $(this).parents('div.has-error').first().removeClass('has-error');
    });

    //change display of checkboxes that are too long
    $('div.checkbox').css({
        'display': 'inline-block',
    });
    if ($(window).width() > 700) {
        $('div.checkbox').css('width', '30%');
    } else {
        $('div.checkbox').css('width', '100%');
    }  
    $(window).resize(function() {
        if ($(window).width() > 700) {
            $('div.checkbox').css('width', '30%');
        } else {
            $('div.checkbox').css('width', '100%');
        }        
    });
    
    // custom adjustments after crispy_forms
    $('#div_id_school').prepend('<br><h2>Academics</h2><h4>Please select the college and major that you are most strongly considering even if you’re not currently in that program. Be mindful that your upperclassman will likely share your academic selections.</h4>'); 
    $('#div_id_extracurriculars').prepend('<br><h2>Extracurriculars</h2>');
    $('#div_id_career').prepend('<br><h2>Career</h2>');
    $('#div_id_sa1').prepend('<br><h2>Short Answer</h2>');
    $('#div_id_partnering').prepend('<br><h2>One last thing</h2>');


}) //end ready
{% endblock script %}
</script>

